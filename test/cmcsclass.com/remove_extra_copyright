#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Remove Extra Copyright Text
Searches for and removes standalone "All rights reserved to Center Marine..." text elements 
that are floating outside the main footer.
"""

import os
import re

TARGET_DIR = r"d:\ypm\my web\test\cmcsclass.com"

# The specific text string to remove. 
# Based on the screenshot, it might be a standalone P or DIV tag.
TARGET_TEXT_PATTERN = r'<[^>]*>\s*All rights reserved to Center Marine Certificate Service\s*</[^>]*>'

def remove_extra_copyright(filepath):
    try:
        with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
            content = f.read()
    except:
        return False
    
    original = content
    
    # Remove the pattern
    # Use re.IGNORECASE just to be safe
    new_content = re.sub(TARGET_TEXT_PATTERN, '', content, flags=re.IGNORECASE)
    
    # Also check for just the text without tag wrapping if it's inside a complex widget structure
    # But be careful not to remove the one inside our new Footer.
    # Our new footer uses "© All rights reserved Center Marine Certificate Service" (symbol © and slightly different wording)
    # The one to remove is "All rights reserved to Center Marine Certificate Service" (no symbol, "to" word)
    
    # Let's double check the exact query string from the user request:
    # "All rights reserved to Center Marine Certificate Service"
    
    # My footer script uses:
    # "© All rights reserved Center Marine Certificate Service"
    
    # So they are different enough. We can safely remove the target string.
    
    loose_pattern = r'All rights reserved to Center Marine Certificate Service'
    
    if loose_pattern in new_content:
        # If the regex didn't catch it (maybe complex nesting), replace the text with empty string
        new_content = new_content.replace('All rights reserved to Center Marine Certificate Service', '')

    if new_content != original:
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(new_content)
        return True
    return False

def main():
    print("=" * 60)
    print("REMOVE EXTRA COPYRIGHT TEXT")
    print("=" * 60)
    
    fixed = 0
    for root, dirs, files in os.walk(TARGET_DIR):
        dirs[:] = [d for d in dirs if d not in ['.git', 'node_modules', 'wp-json']]
        for file in files:
            if file.endswith('.html'):
                if remove_extra_copyright(os.path.join(root, file)):
                    fixed += 1
                    print(f"  Cleaned: {file}")
    
    print(f"\nUpdated {fixed} files")

if __name__ == "__main__":
    main()
